<%- include('partials/header') %>
    <script src="https://js.stripe.com/v3/"></script>

    <main class="container mt-40">
        <h1 class="mb-20">Checkout</h1>
        <div class="dashboard-grid">
            <!-- Left Column: Forms -->
            <div>
                <!-- Contact Information -->
                <div class="card" style="padding: 24px;">
                    <h2 class="mb-20">Contact Information</h2>
                    <form id="checkout-contact-form">
                        <div class="form-group">
                            <label for="fullName" class="form-label">Full Name</label>
                            <input type="text" id="fullName" class="form-input" placeholder="Enter full name" required>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">Email Address</label>
                            <input type="email" id="email" class="form-input" placeholder="Enter email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" id="phone" class="form-input" placeholder="Enter phone number" required>
                        </div>
                    </form>
                </div>

                <!-- Delivery Address -->
                <div class="card mt-20" style="padding: 24px;">
                    <h2 class="mb-20">Delivery Address</h2>
                    <form id="checkout-address-form">
                        <div class="form-group">
                            <label for="country" class="form-label">Country</label>
                            <input type="text" id="country" class="form-input" placeholder="Enter country" required>
                        </div>
                        <div class="form-group">
                            <label for="postcode" class="form-label">Postcode</label>
                            <input type="text" id="postcode" class="form-input" placeholder="Enter postcode" required>
                        </div>
                        <div class="form-group">
                            <label for="city" class="form-label">City</label>
                            <input type="text" id="city" class="form-input" placeholder="Enter city" required>
                        </div>
                        <div class="form-group">
                            <label for="address" class="form-label">Address Lines</label>
                            <textarea id="address" class="form-input" rows="3" placeholder="Enter address lines"
                                required></textarea>
                        </div>
                    </form>
                </div>

                <!-- Payment Method -->
                <div class="card mt-20" style="padding: 24px;">
                    <h2 class="mb-20">Payment Method</h2>
                    <form id="checkout-payment-method-form">
                        <div class="form-group">
                            <label class="form-label">Select Payment Method</label>
                            <div style="display: flex; gap: 20px; margin-top: 10px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                    <input type="radio" name="paymentMethod" value="card" checked>
                                    Credit/Debit Card
                                </label>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Card Details -->
                <div class="card mt-20" style="padding: 24px;" id="card-details-section">
                    <h2 class="mb-20">Card Details</h2>

                    <!-- Test Card Info -->
                    <div
                        style="background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 12px; margin-bottom: 20px; font-size: 0.9rem; color: #495057;">
                        <strong>Test Mode Active</strong><br>
                        Use the following test card numbers:<br>
                        <ul style="margin-top: 5px; padding-left: 20px;">
                            <li>Visa: <strong>4242 4242 4242 4242</strong></li>
                            <li>Mastercard: <strong>5555 5555 5555 4444</strong></li>
                        </ul>
                        Any future date (e.g., 12/30) and CVC (e.g., 123).
                    </div>

                    <form id="payment-form">
                        <div id="payment-element">
                            <!--Stripe.js injects the Payment Element-->
                        </div>
                        <div id="payment-message" class="hidden"></div>
                    </form>

                    <!-- Success Message (Hidden by default) -->
                    <div id="payment-success" style="display: none; text-align: center; padding: 20px;">
                        <div style="color: #28a745; font-size: 48px; margin-bottom: 10px;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3 style="color: #28a745;">Payment Completed!</h3>
                        <p>Redirecting you to your profile...</p>
                    </div>
                </div>
            </div>

            <!-- Right Column: Order Summary -->
            <div>
                <div class="card" style="padding: 24px; position: sticky; top: 100px;">
                    <h2 class="mb-20">Order Summary</h2>
                    <div id="order-summary-items" style="margin-bottom: 20px;">
                        <!-- Items injected via JS -->
                        <p>Loading summary...</p>
                    </div>

                    <div style="border-top: 1px solid var(--border-color); padding-top: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>Subtotal</span>
                            <span id="summary-subtotal">€0.00</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>Shipping</span>
                            <span id="summary-shipping">€0.00</span>
                        </div>
                        <div
                            style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2rem; margin-top: 10px;">
                            <span>Total</span>
                            <span id="summary-total">€0.00</span>
                        </div>
                    </div>

                    <button id="place-order-btn" class="btn btn-primary btn-block mt-20">
                        Proceed to Payment
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script src="/js/checkout.js"></script>

    <%- include('partials/footer') %>